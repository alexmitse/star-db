{"ast":null,"code":"/* eslint-disable no-await-in-loop */\n\n/* eslint-disable class-methods-use-this */\nexport default class SwapiService {\n  constructor() {\n    this.apiBase = 'https://swapi.co/api';\n\n    this.extractId = item => {\n      const idRegExp = /\\/([0-9]*)\\/$/;\n      return item.url.match(idRegExp)[1];\n    };\n\n    this.extractItem = item => {\n      const idRegExp = /\\/([0-9]*)\\/$/;\n      return item.match(idRegExp)[1];\n    };\n\n    this.transformPlanet = planet => {\n      return {\n        id: this.extractId(planet),\n        lable: 'planets',\n        name: planet.name,\n        population: planet.population,\n        rotationPeriod: planet.rotation_period,\n        diameter: planet.diameter\n      };\n    };\n\n    this.transformStarship = starship => {\n      return {\n        id: this.extractId(starship),\n        lable: 'starships',\n        name: starship.name,\n        model: starship.model,\n        manufacturer: starship.manufacturer,\n        costInCredits: starship.cost_in_credits,\n        length: starship.length,\n        crew: starship.crew,\n        passengers: starship.passengers,\n        cargoCapacity: starship.cargo_capacity\n      };\n    };\n\n    this.transformPerson = person => {\n      return {\n        id: person,\n        lable: 'people',\n        name: person.name,\n        gender: person.gender,\n        birthYear: person.birth_year,\n        eyeColor: person.eye_color,\n        homeworld: this.extractItem(person.homeworld),\n        films: person.films.map(this.extractItem),\n        species: person.species.map(this.extractItem),\n        vehicles: person.vehicles.map(this.extractItem),\n        starships: person.starships.map(this.extractItem)\n      };\n    };\n\n    this.transformFilm = film => {\n      return {\n        id: this.extractId(film),\n        lable: 'films',\n        name: film.title,\n        episodeId: film.episode_id,\n        openingCrawl: film.opening_crawl,\n        director: film.director\n      };\n    };\n\n    this.transformSpecies = species => {\n      return {\n        id: this.extractId(species),\n        lable: 'species',\n        name: species.name,\n        classification: species.classification,\n        designation: species.designation,\n        averageHeight: species.average_height\n      };\n    };\n\n    this.transformVehicles = vehicles => {\n      return {\n        id: this.extractId(vehicles),\n        lable: 'vehicles',\n        name: vehicles.name,\n        model: vehicles.model,\n        manufacturer: vehicles.manufacturer,\n        costInCredits: vehicles.cost_in_credits\n      };\n    };\n  }\n\n  async getRequest(url) {\n    const res = await fetch(`${url}`);\n    const resJson = await res.json();\n    return resJson;\n  }\n\n  async getResource(url) {\n    const res = await fetch(`${this.apiBase}${url}`);\n\n    if (!res.ok) {\n      throw new Error(`Could not fetch ${url} , received ${res.status}`);\n    }\n\n    const resJson = await res.json();\n    return resJson;\n  }\n\n  async getAllPeople(number, filter) {\n    let res = {};\n    if (filter) res = await this.getResource(`${filter}`);else res = await fetch(`http://localhost:3000/people?page=${number}`);\n    const resJson = await res.json();\n    return [resJson.results.map(this.transformPerson), resJson.count]; // let res = {};\n    // if (filter) res = await this.getResource(`${filter}`);\n    // else res = await this.getResource(`/people/?page=${number}`);\n    // return [res.results.map(this.transformPerson), res.count];\n  }\n\n  async getPerson(id) {\n    const person = await this.getResource(`/people/${id}/`);\n    return this.transformPerson(person);\n  }\n\n  async getAllPlanets(number, filter) {\n    let res = {};\n    if (filter) res = await this.getResource(`${filter}`);else res = await this.getResource(`/planets/?page=${number}`);\n    return [res.rows.map(this.transformPlanet), res.count];\n  }\n\n  async getPlanet(id) {\n    const planet = await this.getResource(`/planets/${id}/`);\n    return this.transformPlanet(planet);\n  }\n\n  async getAllStarships(number, filter) {\n    let res = {};\n    if (filter) res = await this.getResource(`${filter}`);else res = await this.getResource(`/starships/?page=${number}`);\n    return [res.results.map(this.transformStarship), res.count];\n  }\n\n  async getStarship(id) {\n    const starship = await this.getResource(`/starships/${id}`);\n    return this.transformStarship(starship);\n  }\n\n  async getAllFilms(number, filter) {\n    let res = {};\n    if (filter) res = await this.getResource(`${filter}`);else res = await this.getResource(`/films/?page=${number}`);\n    return [res.results.map(this.transformFilm), res.count];\n  }\n\n  async getFilm(id) {\n    const film = await this.getResource(`/films/${id}`);\n    return this.transformFilm(film);\n  }\n\n  async getAllSpecies(number, filter) {\n    let res = {};\n    if (filter) res = await this.getResource(`${filter}`);else res = await this.getResource(`/species/?page=${number}`);\n    return [res.results.map(this.transformSpecies), res.count];\n  }\n\n  async getSpecies(id) {\n    const species = await this.getResource(`/species/${id}`);\n    return this.transformSpecies(species);\n  }\n\n  async getAllVehicles(number, filter) {\n    let res = {};\n    if (filter) res = await this.getResource(`${filter}`);else res = await this.getResource(`/vehicles/?page=${number}`);\n    return [res.results.map(this.transformSpecies), res.count];\n  }\n\n  async getVehicles(id) {\n    const vehicles = await this.getResource(`/vehicles/${id}`);\n    return this.transformVehicles(vehicles);\n  }\n\n  async getElement(str) {\n    let number = 0;\n    let resPeople = {};\n    let resPlanets = {};\n    let resStarships = {};\n    let resVehicles = {};\n    let resSpecies = {};\n    let resFilms = {};\n\n    do {\n      number += 1;\n      resPeople = await this.getResource(`/people?page=${number}&search=${str}`);\n      resPlanets = await this.getResource(`/planets?page=${number}&search=${str}`);\n      resStarships = await this.getResource(`/starships?page=${number}&search=${str}`);\n      resVehicles = await this.getResource(`/vehicles?page=${number}&search=${str}`);\n      resSpecies = await this.getResource(`/species?page=${number}&search=${str}`);\n      resFilms = await this.getResource(`/films?page=${number}&search=${str}`);\n    } while (resPeople.next); // сделать while для некст пэйдж\n\n\n    return [[...resPeople.results.map(this.transformPerson), // ...resPeopleNext.results.map(this.transformPerson),\n    ...resPlanets.results.map(this.transformPlanet), ...resStarships.results.map(this.transformStarship), ...resVehicles.results.map(this.transformVehicles), ...resSpecies.results.map(this.transformSpecies), ...resFilms.results.map(this.transformFilm)]];\n  }\n\n}","map":{"version":3,"sources":["/home/amitsevich/STAR-DB/star-db/src/services/swapi-service.js"],"names":["SwapiService","apiBase","extractId","item","idRegExp","url","match","extractItem","transformPlanet","planet","id","lable","name","population","rotationPeriod","rotation_period","diameter","transformStarship","starship","model","manufacturer","costInCredits","cost_in_credits","length","crew","passengers","cargoCapacity","cargo_capacity","transformPerson","person","gender","birthYear","birth_year","eyeColor","eye_color","homeworld","films","map","species","vehicles","starships","transformFilm","film","title","episodeId","episode_id","openingCrawl","opening_crawl","director","transformSpecies","classification","designation","averageHeight","average_height","transformVehicles","getRequest","res","fetch","resJson","json","getResource","ok","Error","status","getAllPeople","number","filter","results","count","getPerson","getAllPlanets","rows","getPlanet","getAllStarships","getStarship","getAllFilms","getFilm","getAllSpecies","getSpecies","getAllVehicles","getVehicles","getElement","str","resPeople","resPlanets","resStarships","resVehicles","resSpecies","resFilms","next"],"mappings":"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","sourcesContent":["/* eslint-disable no-await-in-loop */\n/* eslint-disable class-methods-use-this */\nexport default class SwapiService {\n  apiBase = 'https://swapi.co/api';\n\n  async getRequest(url) {\n    const res = await fetch(`${url}`);\n    const resJson = await res.json();\n    return resJson;\n  }\n\n  async getResource(url) {\n    const res = await fetch(`${this.apiBase}${url}`);\n    if (!res.ok) {\n      throw new Error(`Could not fetch ${url} , received ${res.status}`);\n    }\n    const resJson = await res.json();\n    return resJson;\n  }\n\n  async getAllPeople(number, filter) {\n    let res = {};\n    if (filter) res = await this.getResource(`${filter}`);\n    else res = await fetch(`http://localhost:3000/people?page=${number}`);\n    const resJson = await res.json();\n    return [resJson.results.map(this.transformPerson), resJson.count];\n    // let res = {};\n    // if (filter) res = await this.getResource(`${filter}`);\n    // else res = await this.getResource(`/people/?page=${number}`);\n    // return [res.results.map(this.transformPerson), res.count];\n  }\n\n  async getPerson(id) {\n    const person = await this.getResource(`/people/${id}/`);\n    return this.transformPerson(person);\n  }\n\n  async getAllPlanets(number, filter) {\n    let res = {};\n    if (filter) res = await this.getResource(`${filter}`);\n    else res = await this.getResource(`/planets/?page=${number}`);\n    return [res.rows.map(this.transformPlanet), res.count];\n  }\n\n  async getPlanet(id) {\n    const planet = await this.getResource(`/planets/${id}/`);\n    return this.transformPlanet(planet);\n  }\n\n  async getAllStarships(number, filter) {\n    let res = {};\n    if (filter) res = await this.getResource(`${filter}`);\n    else res = await this.getResource(`/starships/?page=${number}`);\n    return [res.results.map(this.transformStarship), res.count];\n  }\n\n  async getStarship(id) {\n    const starship = await this.getResource(`/starships/${id}`);\n    return this.transformStarship(starship);\n  }\n\n  async getAllFilms(number, filter) {\n    let res = {};\n    if (filter) res = await this.getResource(`${filter}`);\n    else res = await this.getResource(`/films/?page=${number}`);\n    return [res.results.map(this.transformFilm), res.count];\n  }\n\n  async getFilm(id) {\n    const film = await this.getResource(`/films/${id}`);\n    return this.transformFilm(film);\n  }\n\n  async getAllSpecies(number, filter) {\n    let res = {};\n    if (filter) res = await this.getResource(`${filter}`);\n    else res = await this.getResource(`/species/?page=${number}`);\n    return [res.results.map(this.transformSpecies), res.count];\n  }\n\n  async getSpecies(id) {\n    const species = await this.getResource(`/species/${id}`);\n    return this.transformSpecies(species);\n  }\n\n  async getAllVehicles(number, filter) {\n    let res = {};\n    if (filter) res = await this.getResource(`${filter}`);\n    else res = await this.getResource(`/vehicles/?page=${number}`);\n    return [res.results.map(this.transformSpecies), res.count];\n  }\n\n  async getVehicles(id) {\n    const vehicles = await this.getResource(`/vehicles/${id}`);\n    return this.transformVehicles(vehicles);\n  }\n\n  async getElement(str) {\n    let number = 0;\n    let resPeople = {};\n    let resPlanets = {};\n    let resStarships = {};\n    let resVehicles = {};\n    let resSpecies = {};\n    let resFilms = {};\n\n    do {\n      number += 1;\n      resPeople = await this.getResource(\n        `/people?page=${number}&search=${str}`,\n      );\n      resPlanets = await this.getResource(\n        `/planets?page=${number}&search=${str}`,\n      );\n      resStarships = await this.getResource(\n        `/starships?page=${number}&search=${str}`,\n      );\n      resVehicles = await this.getResource(\n        `/vehicles?page=${number}&search=${str}`,\n      );\n      resSpecies = await this.getResource(\n        `/species?page=${number}&search=${str}`,\n      );\n      resFilms = await this.getResource(`/films?page=${number}&search=${str}`);\n    } while (resPeople.next);\n    // сделать while для некст пэйдж\n\n    return [\n      [\n        ...resPeople.results.map(this.transformPerson),\n        // ...resPeopleNext.results.map(this.transformPerson),\n        ...resPlanets.results.map(this.transformPlanet),\n        ...resStarships.results.map(this.transformStarship),\n        ...resVehicles.results.map(this.transformVehicles),\n        ...resSpecies.results.map(this.transformSpecies),\n        ...resFilms.results.map(this.transformFilm),\n      ],\n    ];\n  }\n\n  extractId = (item) => {\n    const idRegExp = /\\/([0-9]*)\\/$/;\n    return item.url.match(idRegExp)[1];\n  };\n\n  extractItem = (item) => {\n    const idRegExp = /\\/([0-9]*)\\/$/;\n    return item.match(idRegExp)[1];\n  };\n\n  transformPlanet = (planet) => {\n    return {\n      id: this.extractId(planet),\n      lable: 'planets',\n      name: planet.name,\n      population: planet.population,\n      rotationPeriod: planet.rotation_period,\n      diameter: planet.diameter,\n    };\n  };\n\n  transformStarship = (starship) => {\n    return {\n      id: this.extractId(starship),\n      lable: 'starships',\n      name: starship.name,\n      model: starship.model,\n      manufacturer: starship.manufacturer,\n      costInCredits: starship.cost_in_credits,\n      length: starship.length,\n      crew: starship.crew,\n      passengers: starship.passengers,\n      cargoCapacity: starship.cargo_capacity,\n    };\n  };\n\n  transformPerson = (person) => {\n    return {\n      id: person,\n      lable: 'people',\n      name: person.name,\n      gender: person.gender,\n      birthYear: person.birth_year,\n      eyeColor: person.eye_color,\n      homeworld: this.extractItem(person.homeworld),\n      films: person.films.map(this.extractItem),\n      species: person.species.map(this.extractItem),\n      vehicles: person.vehicles.map(this.extractItem),\n      starships: person.starships.map(this.extractItem),\n    };\n  };\n\n  transformFilm = (film) => {\n    return {\n      id: this.extractId(film),\n      lable: 'films',\n      name: film.title,\n      episodeId: film.episode_id,\n      openingCrawl: film.opening_crawl,\n      director: film.director,\n    };\n  };\n\n  transformSpecies = (species) => {\n    return {\n      id: this.extractId(species),\n      lable: 'species',\n      name: species.name,\n      classification: species.classification,\n      designation: species.designation,\n      averageHeight: species.average_height,\n    };\n  };\n\n  transformVehicles = (vehicles) => {\n    return {\n      id: this.extractId(vehicles),\n      lable: 'vehicles',\n      name: vehicles.name,\n      model: vehicles.model,\n      manufacturer: vehicles.manufacturer,\n      costInCredits: vehicles.cost_in_credits,\n    };\n  };\n}\n"]},"metadata":{},"sourceType":"module"}